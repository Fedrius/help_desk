<!--Ticket section can be broken up into a partial for DRY code.-->

<h1 class="text-center">Admin Help Desk</h1>
<div class="jumbotron table-responsive">
  <div class="btn-group">
    <button type="button" class="btn btn-default" id="tableBtn1">All</button>
    <button type="button" class="btn btn-default" id="tableBtn2">Open</button>
    <button type="button" class="btn btn-default" id="tableBtn3">Closed</button>
  </div>
  <hr/>
  <div id="allTicketsTable">
    <h2>All Tickets</h2>
      <table class="table-bordered table-hover">
        <%= render 'shared/tickets' %>
        <% @tickets.reverse_each do |ticket| %>
          <tr>
            <td><%= link_to "View", edit_ticket_path(ticket), class: "btn btn-primary"  %></td>
            <td><%= ticket.id %></td>
            <td><%= ticket.user.username %></td> 
            <td><%= ticket.title %></td>
            <td><%= ticket.description.truncate(20) %></td>
            <td><%= ticket.issue_type %></td>
            <td><%= ticket.priority %></td>
            <td>
              <span class="<%= ticket.status == "open" ? "bg-danger" : "bg-success" %> ticketStatus">
                <%= ticket.status %>
              </span>
            </td>
            <td><%= ticket.created_at %></td>
          </tr>
        <% end %>
      </table>
  </div>
  <div class="row" id="openTicketsTable">
    <div class="col-md-12">
      <h2>Open</h2>
      <table class="table-bordered table-hover">
      <%= render 'shared/tickets' %>
      <% @tickets.reverse_each do |ticket| %>
        <% if ticket.status == "open" %>
        <tr>
          <td><%= link_to "View", edit_ticket_path(ticket), class: "btn btn-primary"  %></td>
          <td><%= ticket.id %></td>
          <td><%= ticket.user.username %></td> 
          <td><%= ticket.title %></td>
          <td><%= ticket.description.truncate(20) %></td>
          <td><%= ticket.issue_type %></td>
          <td><%= ticket.priority %></td>
          <td>
            <span class="<%= ticket.status == "open" ? "bg-danger" : "bg-success" %> ticketStatus">
              <%= ticket.status %>
            </span>
          </td>
          <td><%= ticket.created_at %></td>
        </tr>
        <% end %>
      <% end %>
      </table>
    </div>
  </div>
  <div class="row" id="closedTicketsTable">
    <div class="col-md-12">
      <h2>Resolved</h2>
      <table class="table-bordered table-hover">
      <%= render 'shared/tickets' %>
      <% @tickets.reverse_each do |ticket| %>
        <% if ticket.status == "resolved" %>
        <tr>      
          <td><%= link_to "View", edit_ticket_path(ticket), class: "btn btn-primary"  %></td>
          <td><%= ticket.id %></td>
          <td><%= ticket.user.username %></td> 
          <td><%= ticket.title %></td>
          <td><%= ticket.description.truncate(20) %></td>
          <td><%= ticket.issue_type %></td>
          <td><%= ticket.priority %></td>
          <td>
            <span class="<%= ticket.status == "open" ? "bg-danger" : "bg-success" %> ticketStatus">
              <%= ticket.status %>
            </span>
          </td>
          <td><%= ticket.created_at %></td>
        </tr>
        <% end %>
      <% end %>
      </table>
    </div>
  </div>
</div>